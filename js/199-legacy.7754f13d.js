"use strict";(self["webpackChunkiview_admin_plus"]=self["webpackChunkiview_admin_plus"]||[]).push([[199],{10199:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var o=n(73396),a=n(87139),i=(0,o._)("span",{class:"ivu-pl-8"},"前端日志",-1),r=(0,o.Uk)("查看");function s(e,t,n,s,c,l){var u=(0,o.up)("Avatar"),g=(0,o.up)("Button"),h=(0,o.up)("Tooltip"),m=(0,o.up)("Tag"),p=(0,o.up)("Table"),f=(0,o.up)("Page"),d=(0,o.up)("Card");return(0,o.wg)(),(0,o.j4)(d,{shadow:""},{title:(0,o.w5)((function(){return[(0,o.Wm)(u,{icon:"md-locate",size:"small",style:{color:"#2f54eb",background:"#f0f5ff"}}),i]})),extra:(0,o.w5)((function(){return[(0,o.Wm)(h,{transfer:"",content:"导出日志",placement:"top"},{default:(0,o.w5)((function(){return[(0,o.Wm)(g,{type:"dashed",icon:"ios-cloud-download-outline",onClick:l.exportLog,style:{"margin-right":"10px"}},null,8,["onClick"])]})),_:1}),(0,o.Wm)(h,{transfer:"",content:"清空日志",placement:"top"},{default:(0,o.w5)((function(){return[(0,o.Wm)(g,{type:"dashed",icon:"md-trash",onClick:e.cleanLog},null,8,["onClick"])]})),_:1})]})),default:(0,o.w5)((function(){return[(0,o._)("div",{class:(0,a.C_)("".concat(e.$config.cssPrefix,"table-no-border"))},[(0,o.Wm)(p,{ref:"table",columns:c.columns,data:c.tableData,onOnSortChange:l.changeSort},{type:(0,o.w5)((function(e){var t=e.row;return[(0,o.Wm)(m,{color:"error"===t.type?"red":"blue"},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(t.type),1)]})),_:2},1032,["color"])]})),page:(0,o.w5)((function(e){var t=e.row;return[(0,o.Uk)((0,a.zw)(t.meta.url),1)]})),request:(0,o.w5)((function(e){var t=e.row;return[(0,o.Uk)((0,a.zw)(t.meta.apiURL),1)]})),more:(0,o.w5)((function(e){var t=e.row;return[(0,o.Wm)(g,{size:"small",ghost:"",type:"primary",onClick:function(e){return l.viewLog(t)}},{default:(0,o.w5)((function(){return[r]})),_:2},1032,["onClick"])]})),_:1},8,["columns","data","onOnSortChange"]),(0,o.Wm)(f,{"show-total":"","show-sizer":"","show-elevator":"",class:"ivu-text-center",total:l.logList.length,onOnChange:l.changePage,onOnPageSizeChange:l.changePageSize},null,8,["total","onOnChange","onOnPageSizeChange"])],2)]})),_:1})}var c=n(95082),l=(n(2707),n(21249),n(47042),n(20065)),u=n(28762),g={name:"SystemLog",data:function(){var e=this;return{columns:[{title:"序号",align:"center",width:65,render:function(t,n){n.row,n.col;var o=n.index;return t("span",(e.currentPage-1)*e.pageSize+o+1)}},{title:"时间",key:"time",width:180,sortable:!0},{title:"类型",key:"type",width:100,slot:"type"},{title:"信息",key:"message"},{title:"触发页面",slot:"page"},{title:"请求地址",slot:"request"},{title:"详细信息",align:"center",width:100,slot:"more"}],tableData:[],currentPage:1,pageSize:10,timeOrder:"desc"}},computed:{logList:function(){return this.$store.state.log.logList}},watch:{logList:function(){this.changePage(this.currentPage)}},created:function(){this.changePage()},methods:(0,c.Z)((0,c.Z)({},(0,l.OI)([u.KM])),{},{exportLog:function(){this.logList.length?this.$refs.table.exportCsv({filename:"错误日志.csv"}):this.$Message.info("没有日志或异常")},viewLog:function(e){this.$Message.info("按F12打开控制台查看完整日志"),this.$console.capsule(this.$config.titleSuffix,"完整日志内容"),console.group("完整日志"),console.log("message: ",e.message),console.log("source: ",e.source),console.log("time: ",e.time),console.log("type: ",e.type),console.log("meta: ",e.meta),console.groupEnd()},changePage:function(e){var t=this;this.currentPage=e||1;var n=(this.currentPage-1)*this.pageSize,o=this.logList.map((function(e){return(0,c.Z)((0,c.Z)({},e),{},{timestamp:new Date(e.time)})})).sort((function(e,n){return"asc"===t.timeOrder?e.timestamp-n.timestamp:n.timestamp-e.timestamp}));this.tableData=o.slice(n,n+this.pageSize)},changePageSize:function(e){this.pageSize=e,this.changePage(this.currentPage)},changeSort:function(e){this.timeOrder=e.order,this.changePage(this.currentPage)}})},h=n(40089);const m=(0,h.Z)(g,[["render",s]]);var p=m}}]);
//# sourceMappingURL=199-legacy.7754f13d.js.map