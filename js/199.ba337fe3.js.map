{"version":3,"file":"js/199.ba337fe3.js","mappings":"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","sources":["webpack://iview-admin-plus/./src/views/tools/system-log.vue","webpack://iview-admin-plus/./src/views/tools/system-log.vue?b4db"],"sourcesContent":["<template>\r\n  <Card shadow>\r\n    <template #title>\r\n      <Avatar icon=\"md-locate\" size=\"small\" style=\"color: #2f54eb; background: #f0f5ff\" />\r\n      <span class=\"ivu-pl-8\">前端日志</span>\r\n    </template>\r\n    <template #extra>\r\n      <Tooltip transfer content=\"导出日志\" placement=\"top\">\r\n        <Button type=\"dashed\" icon=\"ios-cloud-download-outline\" @click=\"exportLog\" style=\"margin-right: 10px\" />\r\n      </Tooltip>\r\n      <Tooltip transfer content=\"清空日志\" placement=\"top\">\r\n        <Button type=\"dashed\" icon=\"md-trash\" @click=\"cleanLog\" />\r\n      </Tooltip>\r\n    </template>\r\n    <div :class=\"`${$config.cssPrefix}table-no-border`\">\r\n      <Table ref=\"table\" :columns=\"columns\" :data=\"tableData\" @on-sort-change=\"changeSort\">\r\n        <template #type=\"{ row }\">\r\n          <Tag :color=\"row.type === `error` ? `red` : `blue`\">{{ row.type }}</Tag>\r\n        </template>\r\n        <template #page=\"{ row }\">{{ row.meta.url }}</template>\r\n        <template #request=\"{ row }\">{{ row.meta.apiURL }}</template>\r\n        <template #more=\"{ row }\">\r\n          <Button size=\"small\" ghost type=\"primary\" @click=\"viewLog(row)\">查看</Button>\r\n        </template>\r\n      </Table>\r\n      <Page\r\n        show-total\r\n        show-sizer\r\n        show-elevator\r\n        class=\"ivu-text-center\"\r\n        :total=\"logList.length\"\r\n        @on-change=\"changePage\"\r\n        @on-page-size-change=\"changePageSize\"\r\n      />\r\n    </div>\r\n  </Card>\r\n</template>\r\n\r\n<script>\r\n  import { mapMutations } from 'vuex'\r\n  import { cleanLog } from '@/store/mutation-types'\r\n\r\n  export default {\r\n    name: 'SystemLog',\r\n    data() {\r\n      return {\r\n        columns: [\r\n          {\r\n            title: '序号',\r\n            align: 'center',\r\n            width: 65,\r\n            render: (h, { row, col, index }) => h('span', (this.currentPage - 1) * this.pageSize + index + 1)\r\n          },\r\n          {\r\n            title: '时间',\r\n            key: 'time',\r\n            width: 180,\r\n            sortable: true\r\n          },\r\n          {\r\n            title: '类型',\r\n            key: 'type',\r\n            width: 100,\r\n            slot: 'type'\r\n          },\r\n          {\r\n            title: '信息',\r\n            key: 'message'\r\n          },\r\n          // {\r\n          //   title: '状态码',\r\n          //   key: 'code',\r\n          //   width: 100,\r\n          //   render: (h, { row }) => {\r\n          //     return (\r\n          //       <span>{row.code === 0 ? '-' : row.code}</span>\r\n          //     )\r\n          //   }\r\n          // },\r\n          {\r\n            title: '触发页面',\r\n            slot: 'page'\r\n          },\r\n          {\r\n            title: '请求地址',\r\n            slot: 'request'\r\n          },\r\n          {\r\n            title: '详细信息',\r\n            align: 'center',\r\n            width: 100,\r\n            slot: 'more'\r\n          }\r\n        ],\r\n        tableData: [],\r\n        currentPage: 1,\r\n        pageSize: 10,\r\n        timeOrder: 'desc'\r\n      }\r\n    },\r\n    computed: {\r\n      logList() {\r\n        return this.$store.state.log.logList\r\n      }\r\n    },\r\n    watch: {\r\n      logList() {\r\n        this.changePage(this.currentPage)\r\n      }\r\n    },\r\n    created() {\r\n      this.changePage()\r\n    },\r\n    methods: {\r\n      ...mapMutations([cleanLog]),\r\n      exportLog() {\r\n        if (!this.logList.length) {\r\n          this.$Message.info('没有日志或异常')\r\n          return\r\n        }\r\n        this.$refs.table.exportCsv({\r\n          filename: '错误日志.csv'\r\n        })\r\n      },\r\n      viewLog(log) {\r\n        this.$Message.info('按F12打开控制台查看完整日志')\r\n        this.$console.capsule(this.$config.titleSuffix, '完整日志内容')\r\n        console.group('完整日志')\r\n        console.log('message: ', log.message)\r\n        console.log('source: ', log.source)\r\n        console.log('time: ', log.time)\r\n        console.log('type: ', log.type)\r\n        console.log('meta: ', log.meta)\r\n        console.groupEnd()\r\n      },\r\n      changePage(currentPage) {\r\n        this.currentPage = currentPage || 1\r\n        const startSize = (this.currentPage - 1) * this.pageSize\r\n        const sortList = this.logList\r\n          .map(item => ({ ...item, timestamp: new Date(item.time) }))\r\n          .sort((a, b) => {\r\n            if (this.timeOrder === 'asc') return a.timestamp - b.timestamp\r\n            return b.timestamp - a.timestamp\r\n          })\r\n        this.tableData = sortList.slice(startSize, startSize + this.pageSize)\r\n      },\r\n      changePageSize(pageSize) {\r\n        this.pageSize = pageSize\r\n        this.changePage(this.currentPage)\r\n      },\r\n      changeSort(params) {\r\n        this.timeOrder = params.order\r\n        this.changePage(this.currentPage)\r\n      }\r\n    }\r\n  }\r\n</script>\r\n","import { render } from \"./system-log.vue?vue&type=template&id=21ed5b6c\"\nimport script from \"./system-log.vue?vue&type=script&lang=js\"\nexport * from \"./system-log.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\miBookPro\\\\Desktop\\\\dev\\\\iview-admin-plus\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","_createBlock","_component_Card","shadow","title","_createVNode","_component_Avatar","icon","size","style","_hoisted_1","extra","_component_Tooltip","transfer","content","placement","_component_Button","type","onClick","$options","_ctx","cssPrefix","_component_Table","ref","columns","$data","data","onOnSortChange","row","_component_Tag","color","page","meta","url","request","apiURL","more","ghost","_component_Page","total","length","onOnChange","onOnPageSizeChange","name","align","width","render","h","col","index","this","currentPage","pageSize","key","sortable","slot","tableData","timeOrder","computed","logList","$store","state","log","watch","changePage","created","methods","mapMutations","cleanLog","exportLog","$refs","table","exportCsv","filename","$Message","info","viewLog","$console","capsule","$config","titleSuffix","console","group","message","source","time","groupEnd","startSize","sortList","map","item","timestamp","Date","sort","a","b","slice","changePageSize","changeSort","params","order","__exports__"],"sourceRoot":""}